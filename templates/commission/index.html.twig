{% extends 'admin_base.html.twig' %}

{% block title %}Commission Management{% endblock %}
{% block header %}Commissions{% endblock %}

{% block body %}
<div class="card p-4 shadow-sm border-0" style="border-radius: 12px; background: #fff;">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="fw-bold text-primary" style="color:#370d46ff;">Commission List</h4>
    <a href="{{ path('app_commission_new') }}" class="btn btn-primary" style="background:#370d46ff;border:none;border-radius:50px;padding:8px 20px;">
      <i class="bi bi-plus-circle me-1"></i> Create New
    </a>
  </div>

  <div class="table-responsive">
    <table id="commissionTable" class="table table-striped table-hover align-middle">
      <thead class="table-dark" style="background:#370d46ff;">
        <tr>
          <th>ID</th>
          <th>Title</th>
          <th>Category</th>
          <th>Description</th>
          <th>Price</th>
          <th>Status</th>
          <th>Created At</th>
          <th>Updated At</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for commission in commissions %}
          <tr>
            <td>{{ commission.id }}</td>
            <td>{{ commission.title }}</td>
            <td>{{ commission.category ? commission.category.name : 'Uncategorized' }}</td>
            <td>{{ commission.description|length > 50 ? commission.description|slice(0,50) ~ '...' : commission.description }}</td>
            <td>‚Ç±{{ commission.price }}</td>
            <td>
              {% if commission.status == 'Completed' %}
                <span class="badge bg-success">{{ commission.status }}</span>
              {% elseif commission.status == 'Pending' %}
                <span class="badge bg-warning text-dark">{{ commission.status }}</span>
              {% else %}
                <span class="badge bg-secondary">{{ commission.status }}</span>
              {% endif %}
            </td>
            <td>{{ commission.createdAt ? commission.createdAt|date('Y-m-d H:i') : '' }}</td>
            <td>{{ commission.updatedAt ? commission.updatedAt|date('Y-m-d H:i') : '' }}</td>
            <td>
              <a href="{{ path('app_commission_show', {'id': commission.id}) }}" class="btn btn-success btn-sm rounded-pill">
                <i class="bi bi-eye"></i>
              </a>
              <a href="{{ path('app_commission_edit', {'id': commission.id}) }}" class="btn btn-warning btn-sm rounded-pill text-white">
                <i class="bi bi-pencil-square"></i>
              </a>
            </td>
          </tr>
        {% else %}
          <tr>
            <td colspan="9" class="text-center py-3 text-muted">No records found</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    $('#commissionTable').DataTable({
      pageLength: 5,
      lengthMenu: [5, 10, 25, 50],
      order: [[0, 'desc']],
      language: {
        search: "üîç Search commissions:",
        lengthMenu: "_MENU_ per page",
        info: "Showing _START_ to _END_ of _TOTAL_ commissions",
        zeroRecords: "No matching records found",
        paginate: { next: "‚Ä∫", previous: "‚Äπ" }
      }
    });
  });
</script>
{% endblock %}